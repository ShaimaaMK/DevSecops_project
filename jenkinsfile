pipeline{
   agent any
   //environment {
     //   MAIL_HOST = 'localhost'
       // MAIL_PORT = '1025'
        //DATABASE_USER = 'root'
        //DATABASE_PASSWORD = 'ez7mz'
//        DATABASE_URI = 'jdbc:mysql://mysqldb:3306/smartcity_project?createDatabaseIfNotExist=true'

  //  }
   stages {
     stage ('git checkout'){
       steps{
         git url: 'https://github.com/ShaimaaMK/DevSecops_project.git', branch: 'master'
       }
     }

     stage ('unit testing') {
    environment {
        DB_HOST = 'mysqldb'
        DB_USER = 'root'
        DB_PASS = 'ez7mz'
    }
    steps {
        script {
            sh 'mvn test -Ddb.host=${DB_HOST} -Ddb.user=${DB_USER} -Ddb.pass=${DB_PASS}'
        }
    }
}

           stage ('integration testing') {
              steps{
                  script{
                      sh 'mvn verify -DskipUnitTests'
                  }
              }
           }
           stage ('checkstyle testing') {
              steps{
                  script{
                      sh 'mvn checkstyle:check'
                  }
              }
     }
   }
}
